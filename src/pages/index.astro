---
import BaseLayout from "../layouts/BaseLayout.astro";
const pageTitle = "Home Page";
const builderAPIpublicKey = "dba729849b1646e2b89413d09a1e6c11";

const handleError = (err) => {
	// The requested Builder content could not be found.
	if (err.response.status === 404) {
		return { data: null };
	}
	throw err;
};

const encodedUrl = encodeURIComponent(Astro.request.url);
console.log(encodedUrl);

const { data: pageData } = await fetch(
	`https://cdn.builder.io/api/v1/html/page?apiKey=${builderAPIpublicKey}&url=${encodedUrl}`
)
	.then((res) => res.json())
	.catch(handleError);
---

<BaseLayout pageTitle={pageTitle}>
	{pageData && pageData.html}
</BaseLayout>
